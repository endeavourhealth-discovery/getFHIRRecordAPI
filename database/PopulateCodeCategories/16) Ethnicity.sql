
insert into code_category_values (code_category_id, concept_dbid)
SELECT distinct 16, s.dbid-- , s.id, s.name, p2.id, p2.name, i.id, i.name, p.id, p.name, c.id, c.name
FROM concept c																			-- Source SNOMED concept
JOIN concept p ON p.id = 'SN_116680003'													-- "Is A" relationship (child of code)
JOIN concept_tct t ON t.target = c.dbid AND t.property = p.dbid							-- All children, grand children, etc
JOIN concept i ON i.dbid = t.source														-- Intermediary (just for info)
JOIN concept p2 ON p2.id IN ('SN_116680003', 'is_equivalent_to')						-- "Is A" and "Equivalent" relationships (self and legacy maps)
JOIN concept_property_object cpo ON cpo.value = t.source AND cpo.property = p2.dbid		-- All related
JOIN concept s ON s.dbid = cpo.dbid														-- Concepts
WHERE c.id in (
'SN_18167009',
'SN_33897005',
'SN_80208004',
'SN_160531006',
'SN_185984009',
'SN_185988007',
'SN_185989004',
'SN_185990008',
'SN_185993005',
'SN_185995003',
'SN_185996002',
'SN_185989004',
'SN_185998001',
'SN_185999009',
'SN_186000006',
'SN_414481008',
'SN_186002003',
'SN_186003008',
'SN_186005001',
'SN_186006000',
'SN_186007009',
'SN_186010002',
'SN_186012005',
'SN_186013000',
'SN_186014006',
'SN_186017004',
'SN_186005001',
'SN_186019001',
'SN_186020007',
'SN_186021006',
'SN_186022004',
'SN_186023009',
'SN_397731000',
'SN_186034007',
'SN_186035008',
'SN_186036009',
'SN_186036009',
'SN_186037000',
'SN_186039002',
'SN_186040000',
'SN_186041001',
'SN_186042008',
'SN_372148003',
'SN_186044009',
'SN_315280000',
'SN_186035008',
'SN_186035008',
'SN_270460000',
'SN_270461001',
'SN_270463003',
'SN_270464009',
'SN_270465005',
'SN_270466006',
'SN_270467002',
'SN_275586009',
'SN_275587000',
'SN_275588005',
'SN_275589002',
'SN_275590006',
'SN_275591005',
'SN_275592003',
'SN_275593008',
'SN_275594002',
'SN_275595001',
'SN_275596000',
'SN_275597009',
'SN_275599007',
'SN_275600005',
'SN_275601009',
'SN_275602002',
'SN_309643000',
'SN_309644006',
'SN_312859007',
'SN_763726001',
'SN_312861003',
'SN_315236000',
'SN_315237009',
'SN_185984009',
'SN_315239007',
'SN_315240009',
'SN_315240009',
'SN_315279003',
'SN_315281001',
'SN_372148003',
'SN_315283003',
'SN_315634007',
'SN_315635008',
'SN_69865008',
'SN_81560001',
'SN_86275006',
'SN_401213008',
'SN_401214002',
'SN_413773004',
'SN_86461000000107',
'SN_88911000000101',
'SN_88921000000107',
'SN_88931000000109',
'SN_88941000000100',
'SN_88971000000106',
'SN_88991000000105',
'SN_89001000000105',
'SN_89011000000107',
'SN_89021000000101',
'SN_89031000000104',
'SN_92381000000106',
'SN_92401000000106',
'SN_92411000000108',
'SN_92421000000102',
'SN_92431000000100',
'SN_92441000000109',
'SN_92451000000107',
'SN_92461000000105',
'SN_92481000000101',
'SN_92491000000104',
'SN_92511000000107',
'SN_92521000000101',
'SN_92531000000104',
'SN_92541000000108',
'SN_92551000000106',
'SN_92561000000109',
'SN_92571000000102',
'SN_92581000000100',
'SN_92591000000103',
'SN_92601000000109',
'SN_92631000000103',
'SN_92641000000107',
'SN_92651000000105',
'SN_92661000000108',
'SN_92671000000101',
'SN_92681000000104',
'SN_92691000000102',
'SN_92711000000100',
'SN_92731000000108',
'SN_92751000000101',
'SN_92761000000103',
'SN_92771000000105',
'SN_92781000000107',
'SN_92791000000109',
'SN_93921000000101',
'SN_93931000000104',
'SN_93941000000108',
'SN_93951000000106',
'SN_93981000000100',
'SN_93991000000103',
'SN_94001000000108',
'SN_94021000000104',
'SN_94031000000102',
'SN_94061000000107',
'SN_94081000000103',
'SN_94091000000101',
'SN_94101000000109',
'SN_94111000000106',
'SN_94131000000103',
'SN_94141000000107',
'SN_94151000000105',
'SN_107691000000105',
'SN_110401000000103',
'SN_110751000000108',
'SN_110761000000106',
'SN_110771000000104',
'SN_110781000000102',
'SN_110791000000100',
'SN_110831000000107',
'SN_88981000000108',
'SN_92391000000108',
'SN_92501000000105',
'SN_92611000000106',
'SN_92721000000106',
'SN_93961000000109',
'SN_413465009',
'SN_413466005',
'SN_90027003',
'SN_186003008',
'SN_413773004',
'SN_33897005',
'SN_414551003',
'SN_38361009',
'SN_414752008',
'SN_414978006',
'SN_186002003',
'SN_415794004',
'SN_185988007',
'SN_270462008',
'SN_296841000000102',
'SN_33897005',
'SN_397731000',
'SN_414481008',
'SN_40182006',
'SN_88951000000102',
'SN_88961000000104',
'SN_94011000000105',
'SN_94041000000106',
'SN_94051000000109',
'SN_92621000000100',
'SN_92471000000103',
'SN_92701000000102',
'SN_92741000000104',
'SN_94071000000100',
'SN_94121000000100',
'SN_494131000000105',
'SN_494161000000100',
'SN_445343003',
'SN_29343004',
'SN_286009',
'SN_36329002',
'SN_718131000000106',
'SN_1573191000006100',
'SN_1573201000006100',
'SN_1745831000006110',
'SN_976631000000101',
'SN_976671000000104',
'SN_976691000000100',
'SN_976711000000103',
'SN_976731000000106',
'SN_976751000000104',
'SN_976771000000108',
'SN_976791000000107',
'SN_976811000000108',
'SN_976831000000100',
'SN_976851000000107',
'SN_976871000000103',
'SN_976891000000104',
'SN_976911000000101',
'SN_976931000000109',
'SN_976951000000102',
'SN_976971000000106',
'SN_977371000000109',
'SN_977391000000108',
'SN_977411000000108',
'SN_977431000000100',
'SN_977551000000106',
'SN_977591000000103',
'SN_977711000000100',
'SN_977731000000108',
'SN_977751000000101',
'SN_977771000000105',
'SN_977791000000109',
'SN_977811000000105',
'SN_977831000000102',
'SN_977851000000109',
'SN_977871000000100',
'SN_977971000000108',
'SN_978031000000109',
'SN_978051000000102',
'SN_978071000000106',
'SN_978111000000100',
'SN_978171000000105',
'SN_978191000000109',
'SN_978211000000108',
'SN_978231000000100',
'SN_978251000000107',
'SN_978271000000103',
'SN_978341000000102',
'SN_978361000000101',
'SN_978381000000105',
'SN_978401000000105',
'SN_976551000000109',
'SN_976571000000100',
'SN_976591000000101',
'SN_976611000000109',
'SN_976651000000108',
'SN_977351000000100',
'SN_977911000000103',
'SN_977931000000106',
'SN_977951000000104',
'SN_978011000000101',
'SN_718961001',
'SN_718959005',
'SN_718963003',
'SN_718964009',
'SN_718960000',
'SN_718962008',
'SN_718958002',
'SN_29343004',
'SN_40182006',
'SN_186006000',
'SN_186007009',
'SN_186020007',
'SN_186021006',
'SN_186022004',
'SN_186023009',
'SN_186034007',
'SN_186042008',
'SN_270460000',
'SN_365455004',
'SN_365455004',
'SN_372148003',
'SN_397731000',
'SN_397731000',
'SN_413773004',
'SN_413773004',
'SN_763726001'
)

union

SELECT distinct 16, i.dbid
FROM concept c																			-- Source SNOMED concept
JOIN concept p ON p.id = 'SN_116680003'													-- "Is A" relationship (child of code)
JOIN concept_tct t ON t.target = c.dbid AND t.property = p.dbid							-- All children, grand children, etc
JOIN concept i ON i.dbid = t.source														-- Concepts
WHERE c.id IN (
'SN_18167009',
'SN_33897005',
'SN_80208004',
'SN_160531006',
'SN_185984009',
'SN_185988007',
'SN_185989004',
'SN_185990008',
'SN_185993005',
'SN_185995003',
'SN_185996002',
'SN_185989004',
'SN_185998001',
'SN_185999009',
'SN_186000006',
'SN_414481008',
'SN_186002003',
'SN_186003008',
'SN_186005001',
'SN_186006000',
'SN_186007009',
'SN_186010002',
'SN_186012005',
'SN_186013000',
'SN_186014006',
'SN_186017004',
'SN_186005001',
'SN_186019001',
'SN_186020007',
'SN_186021006',
'SN_186022004',
'SN_186023009',
'SN_397731000',
'SN_186034007',
'SN_186035008',
'SN_186036009',
'SN_186036009',
'SN_186037000',
'SN_186039002',
'SN_186040000',
'SN_186041001',
'SN_186042008',
'SN_372148003',
'SN_186044009',
'SN_315280000',
'SN_186035008',
'SN_186035008',
'SN_270460000',
'SN_270461001',
'SN_270463003',
'SN_270464009',
'SN_270465005',
'SN_270466006',
'SN_270467002',
'SN_275586009',
'SN_275587000',
'SN_275588005',
'SN_275589002',
'SN_275590006',
'SN_275591005',
'SN_275592003',
'SN_275593008',
'SN_275594002',
'SN_275595001',
'SN_275596000',
'SN_275597009',
'SN_275599007',
'SN_275600005',
'SN_275601009',
'SN_275602002',
'SN_309643000',
'SN_309644006',
'SN_312859007',
'SN_763726001',
'SN_312861003',
'SN_315236000',
'SN_315237009',
'SN_185984009',
'SN_315239007',
'SN_315240009',
'SN_315240009',
'SN_315279003',
'SN_315281001',
'SN_372148003',
'SN_315283003',
'SN_315634007',
'SN_315635008',
'SN_69865008',
'SN_81560001',
'SN_86275006',
'SN_401213008',
'SN_401214002',
'SN_413773004',
'SN_86461000000107',
'SN_88911000000101',
'SN_88921000000107',
'SN_88931000000109',
'SN_88941000000100',
'SN_88971000000106',
'SN_88991000000105',
'SN_89001000000105',
'SN_89011000000107',
'SN_89021000000101',
'SN_89031000000104',
'SN_92381000000106',
'SN_92401000000106',
'SN_92411000000108',
'SN_92421000000102',
'SN_92431000000100',
'SN_92441000000109',
'SN_92451000000107',
'SN_92461000000105',
'SN_92481000000101',
'SN_92491000000104',
'SN_92511000000107',
'SN_92521000000101',
'SN_92531000000104',
'SN_92541000000108',
'SN_92551000000106',
'SN_92561000000109',
'SN_92571000000102',
'SN_92581000000100',
'SN_92591000000103',
'SN_92601000000109',
'SN_92631000000103',
'SN_92641000000107',
'SN_92651000000105',
'SN_92661000000108',
'SN_92671000000101',
'SN_92681000000104',
'SN_92691000000102',
'SN_92711000000100',
'SN_92731000000108',
'SN_92751000000101',
'SN_92761000000103',
'SN_92771000000105',
'SN_92781000000107',
'SN_92791000000109',
'SN_93921000000101',
'SN_93931000000104',
'SN_93941000000108',
'SN_93951000000106',
'SN_93981000000100',
'SN_93991000000103',
'SN_94001000000108',
'SN_94021000000104',
'SN_94031000000102',
'SN_94061000000107',
'SN_94081000000103',
'SN_94091000000101',
'SN_94101000000109',
'SN_94111000000106',
'SN_94131000000103',
'SN_94141000000107',
'SN_94151000000105',
'SN_107691000000105',
'SN_110401000000103',
'SN_110751000000108',
'SN_110761000000106',
'SN_110771000000104',
'SN_110781000000102',
'SN_110791000000100',
'SN_110831000000107',
'SN_88981000000108',
'SN_92391000000108',
'SN_92501000000105',
'SN_92611000000106',
'SN_92721000000106',
'SN_93961000000109',
'SN_413465009',
'SN_413466005',
'SN_90027003',
'SN_186003008',
'SN_413773004',
'SN_33897005',
'SN_414551003',
'SN_38361009',
'SN_414752008',
'SN_414978006',
'SN_186002003',
'SN_415794004',
'SN_185988007',
'SN_270462008',
'SN_296841000000102',
'SN_33897005',
'SN_397731000',
'SN_414481008',
'SN_40182006',
'SN_88951000000102',
'SN_88961000000104',
'SN_94011000000105',
'SN_94041000000106',
'SN_94051000000109',
'SN_92621000000100',
'SN_92471000000103',
'SN_92701000000102',
'SN_92741000000104',
'SN_94071000000100',
'SN_94121000000100',
'SN_494131000000105',
'SN_494161000000100',
'SN_445343003',
'SN_29343004',
'SN_286009',
'SN_36329002',
'SN_718131000000106',
'SN_1573191000006100',
'SN_1573201000006100',
'SN_1745831000006110',
'SN_976631000000101',
'SN_976671000000104',
'SN_976691000000100',
'SN_976711000000103',
'SN_976731000000106',
'SN_976751000000104',
'SN_976771000000108',
'SN_976791000000107',
'SN_976811000000108',
'SN_976831000000100',
'SN_976851000000107',
'SN_976871000000103',
'SN_976891000000104',
'SN_976911000000101',
'SN_976931000000109',
'SN_976951000000102',
'SN_976971000000106',
'SN_977371000000109',
'SN_977391000000108',
'SN_977411000000108',
'SN_977431000000100',
'SN_977551000000106',
'SN_977591000000103',
'SN_977711000000100',
'SN_977731000000108',
'SN_977751000000101',
'SN_977771000000105',
'SN_977791000000109',
'SN_977811000000105',
'SN_977831000000102',
'SN_977851000000109',
'SN_977871000000100',
'SN_977971000000108',
'SN_978031000000109',
'SN_978051000000102',
'SN_978071000000106',
'SN_978111000000100',
'SN_978171000000105',
'SN_978191000000109',
'SN_978211000000108',
'SN_978231000000100',
'SN_978251000000107',
'SN_978271000000103',
'SN_978341000000102',
'SN_978361000000101',
'SN_978381000000105',
'SN_978401000000105',
'SN_976551000000109',
'SN_976571000000100',
'SN_976591000000101',
'SN_976611000000109',
'SN_976651000000108',
'SN_977351000000100',
'SN_977911000000103',
'SN_977931000000106',
'SN_977951000000104',
'SN_978011000000101',
'SN_718961001',
'SN_718959005',
'SN_718963003',
'SN_718964009',
'SN_718960000',
'SN_718962008',
'SN_718958002',
'SN_29343004',
'SN_40182006',
'SN_186006000',
'SN_186007009',
'SN_186020007',
'SN_186021006',
'SN_186022004',
'SN_186023009',
'SN_186034007',
'SN_186042008',
'SN_270460000',
'SN_365455004',
'SN_365455004',
'SN_372148003',
'SN_397731000',
'SN_397731000',
'SN_413773004',
'SN_413773004',
'SN_763726001'
);