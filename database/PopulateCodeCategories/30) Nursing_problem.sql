
insert into code_category_values (code_category_id, concept_dbid)
SELECT distinct 30, s.dbid-- , s.id, s.name, p2.id, p2.name, i.id, i.name, p.id, p.name, c.id, c.name
FROM concept c																			-- Source SNOMED concept
JOIN concept p ON p.id = 'SN_116680003'													-- "Is A" relationship (child of code)
JOIN concept_tct t ON t.target = c.dbid AND t.property = p.dbid							-- All children, grand children, etc
JOIN concept i ON i.dbid = t.source														-- Intermediary (just for info)
JOIN concept p2 ON p2.id IN ('SN_116680003', 'is_equivalent_to')						-- "Is A" and "Equivalent" relationships (self and legacy maps)
JOIN concept_property_object cpo ON cpo.value = t.source AND cpo.property = p2.dbid		-- All related
JOIN concept s ON s.dbid = cpo.dbid														-- Concepts
WHERE c.id in (
'SN_958411000006102',
'SN_958421000006105',
'SN_958431000006108',
'SN_958441000006103',
'SN_958541000006102',
'SN_958551000006100',
'SN_958561000006103',
'SN_958571000006105',
'SN_958581000006108',
'SN_958591000006106',
'SN_958601000006103',
'SN_958611000006100',
'SN_958621000006108',
'SN_958631000006106',
'SN_958641000006101',
'SN_958651000006104',
'SN_958661000006102',
'SN_958671000006109',
'SN_958681000006107',
'SN_958691000006105',
'SN_958701000006105',
'SN_958711000006108',
'SN_958721000006100',
'SN_958731000006102',
'SN_958741000006107',
'SN_958751000006109',
'SN_958761000006106',
'SN_958771000006104',
'SN_958791000006103',
'SN_958801000006102',
'SN_958831000006105',
'SN_958851000006103',
'SN_958881000006106',
'SN_958891000006109',
'SN_958901000006108',
'SN_958911000006106',
'SN_958921000006103',
'SN_958941000006105',
'SN_958951000006107',
'SN_958961000006109',
'SN_981431000006107',
'SN_981551000006104',
'SN_981631000006105'
)

union

SELECT distinct 30, i.dbid
FROM concept c																			-- Source SNOMED concept
JOIN concept p ON p.id = 'SN_116680003'													-- "Is A" relationship (child of code)
JOIN concept_tct t ON t.target = c.dbid AND t.property = p.dbid							-- All children, grand children, etc
JOIN concept i ON i.dbid = t.source														-- Concepts
WHERE c.id IN (
'SN_958411000006102',
'SN_958421000006105',
'SN_958431000006108',
'SN_958441000006103',
'SN_958541000006102',
'SN_958551000006100',
'SN_958561000006103',
'SN_958571000006105',
'SN_958581000006108',
'SN_958591000006106',
'SN_958601000006103',
'SN_958611000006100',
'SN_958621000006108',
'SN_958631000006106',
'SN_958641000006101',
'SN_958651000006104',
'SN_958661000006102',
'SN_958671000006109',
'SN_958681000006107',
'SN_958691000006105',
'SN_958701000006105',
'SN_958711000006108',
'SN_958721000006100',
'SN_958731000006102',
'SN_958741000006107',
'SN_958751000006109',
'SN_958761000006106',
'SN_958771000006104',
'SN_958791000006103',
'SN_958801000006102',
'SN_958831000006105',
'SN_958851000006103',
'SN_958881000006106',
'SN_958891000006109',
'SN_958901000006108',
'SN_958911000006106',
'SN_958921000006103',
'SN_958941000006105',
'SN_958951000006107',
'SN_958961000006109',
'SN_981431000006107',
'SN_981551000006104',
'SN_981631000006105'
);