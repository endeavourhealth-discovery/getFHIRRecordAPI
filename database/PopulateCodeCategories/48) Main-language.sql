
insert into code_category_values (code_category_id, concept_dbid)
SELECT distinct 48, s.dbid-- , s.id, s.name, p2.id, p2.name, i.id, i.name, p.id, p.name, c.id, c.name
FROM concept c																			-- Source SNOMED concept
JOIN concept p ON p.id = 'SN_116680003'													-- "Is A" relationship (child of code)
JOIN concept_tct t ON t.target = c.dbid AND t.property = p.dbid							-- All children, grand children, etc
JOIN concept i ON i.dbid = t.source														-- Intermediary (just for info)
JOIN concept p2 ON p2.id IN ('SN_116680003', 'is_equivalent_to')						-- "Is A" and "Equivalent" relationships (self and legacy maps)
JOIN concept_property_object cpo ON cpo.value = t.source AND cpo.property = p2.dbid		-- All related
JOIN concept s ON s.dbid = cpo.dbid														-- Concepts
WHERE c.id in (
'SN_414640006',
'SN_970701000000103',
'SN_970471000000104',
'SN_970601000000105',
'SN_729051000000103',
'SN_970851000000105',
'SN_970501000000106',
'SN_970751000000102',
'SN_970971000000109',
'SN_970621000000101',
'SN_970871000000101',
'SN_970521000000102',
'SN_809341000000106',
'SN_970771000000106',
'SN_971041000000105',
'SN_312954003',
'SN_970801000000109',
'SN_698658006',
'SN_698659003',
'SN_698656005',
'SN_698657001',
'SN_698654008',
'SN_698655009',
'SN_698653002',
'SN_698652007',
'SN_698651000',
'SN_698672002',
'SN_698671009',
'SN_698670005',
'SN_698677008',
'SN_698676004',
'SN_698675000',
'SN_698673007',
'SN_698674001',
'SN_698679006',
'SN_698678003',
'SN_698668001',
'SN_698669009',
'SN_698660008',
'SN_698663005',
'SN_698661007',
'SN_698662000',
'SN_698665003',
'SN_698664004',
'SN_698667006',
'SN_698666002',
'SN_698683006',
'SN_698684000',
'SN_698685004',
'SN_698680009',
'SN_698681008',
'SN_698682001',
'SN_970441000000105',
'SN_698919003',
'SN_698918006',
'SN_698923006',
'SN_698924000',
'SN_698926003',
'SN_698925004',
'SN_698927007',
'SN_698928002',
'SN_698929005',
'SN_698920009',
'SN_698921008',
'SN_698922001',
'SN_698932008',
'SN_698930000',
'SN_698935005',
'SN_698936006',
'SN_698933003',
'SN_698934009',
'SN_698910004',
'SN_698912007',
'SN_698911000',
'SN_698915009',
'SN_698914008',
'SN_698913002',
'SN_698917001',
'SN_698916005',
'SN_698904004',
'SN_698905003',
'SN_698906002',
'SN_698907006',
'SN_698908001',
'SN_698909009',
'SN_698903005',
'SN_698902000',
'SN_698901007',
'SN_698900008',
'SN_698888000',
'SN_698889008',
'SN_698886001',
'SN_698887005',
'SN_698885002',
'SN_698894008',
'SN_698895009',
'SN_698896005',
'SN_698897001',
'SN_698890004',
'SN_698891000',
'SN_698892007',
'SN_698893002',
'SN_698898006',
'SN_698899003',
'SN_970691000000103',
'SN_970921000000105',
'SN_407661002',
'SN_407659006',
'SN_407654001',
'SN_407657008',
'SN_407656004',
'SN_407655000',
'SN_407650005',
'SN_407652002',
'SN_407648002',
'SN_407643006',
'SN_407642001',
'SN_970821000000100',
'SN_970491000000100',
'SN_970721000000107',
'SN_729041000000101',
'SN_970941000000103',
'SN_971011000000109',
'SN_970741000000100',
'SN_970541000000109',
'SN_970991000000108',
'SN_970641000000108',
'SN_699945003',
'SN_971031000000101',
'SN_970661000000109',
'SN_408525000',
'SN_408526004',
'SN_408527008',
'SN_408529006',
'SN_408528003',
'SN_408521009',
'SN_408522002',
'SN_408523007',
'SN_408524001',
'SN_408520005',
'SN_408535006',
'SN_408533004',
'SN_408534005',
'SN_408531002',
'SN_408532009',
'SN_408530001',
'SN_408507007',
'SN_408514009',
'SN_408513003',
'SN_408518007',
'SN_408519004',
'SN_408515005',
'SN_408517002',
'SN_408516006',
'SN_970461000000106',
'SN_970561000000105',
'SN_970711000000101',
'SN_511841000000102',
'SN_315566006',
'SN_315568007',
'SN_315567002',
'SN_315569004',
'SN_315571004',
'SN_315570003',
'SN_315572006',
'SN_315575008',
'SN_315574007',
'SN_315577000',
'SN_315576009',
'SN_315578005',
'SN_315579002',
'SN_315584008',
'SN_315585009',
'SN_315586005',
'SN_315587001',
'SN_315588006',
'SN_315589003',
'SN_315580004',
'SN_315581000',
'SN_315582007',
'SN_315583002',
'SN_970811000000106',
'SN_970681000000100',
'SN_970511000000108',
'SN_970481000000102',
'SN_718512007',
'SN_970611000000107',
'SN_729061000000100',
'SN_970961000000102',
'SN_970631000000104',
'SN_503511000000100',
'SN_609093008',
'SN_609092003',
'SN_609095001',
'SN_609094002',
'SN_970781000000108',
'SN_970911000000104',
'SN_970531000000100',
'SN_970881000000104',
'SN_395110009',
'SN_395109004',
'SN_395108007',
'SN_970551000000107',
'SN_970651000000106',
'SN_910241000000102',
'SN_971021000000103',
'SN_764526007',
'SN_970831000000103',
'SN_970931000000107',
'SN_970451000000108'
);