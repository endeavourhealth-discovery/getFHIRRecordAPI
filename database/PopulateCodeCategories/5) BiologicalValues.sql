
insert into code_category_values (code_category_id, concept_dbid)
SELECT distinct 5, s.dbid-- , s.id, s.name, p2.id, p2.name, i.id, i.name, p.id, p.name, c.id, c.name
FROM concept c																			-- Source SNOMED concept
JOIN concept p ON p.id = 'SN_116680003'													-- "Is A" relationship (child of code)
JOIN concept_tct t ON t.target = c.dbid AND t.property = p.dbid							-- All children, grand children, etc
JOIN concept i ON i.dbid = t.source														-- Intermediary (just for info)
JOIN concept p2 ON p2.id IN ('SN_116680003', 'is_equivalent_to')						-- "Is A" and "Equivalent" relationships (self and legacy maps)
JOIN concept_property_object cpo ON cpo.value = t.source AND cpo.property = p2.dbid		-- All related
JOIN concept s ON s.dbid = cpo.dbid														-- Concepts
WHERE c.id in (
'SN_60621009',
'SN_87179004',
'SN_102584008',
'SN_248333004',
'SN_162758008',
'SN_162759000',
'SN_162761009',
'SN_248333004',
'SN_27113001',
'SN_162765000',
'SN_162766004',
'SN_162769006',
'SN_27113001',
'SN_35425004',
'SN_48499001',
'SN_6497000',
'SN_162863004',
'SN_162864005',
'SN_162879003',
'SN_78564009',
'SN_162987003',
'SN_162988008',
'SN_162989000',
'SN_162990009',
'SN_162991008',
'SN_162992001',
'SN_162993006',
'SN_162994000',
'SN_162995004',
'SN_162986007',
'SN_163020007',
'SN_163020007',
'SN_163020007',
'SN_163021006',
'SN_163022004',
'SN_163023009',
'SN_163024003',
'SN_163025002',
'SN_163026001',
'SN_163027005',
'SN_163028000',
'SN_163029008',
'SN_163032006',
'SN_163033001',
'SN_163034007',
'SN_163035008',
'SN_163036009',
'SN_163037000',
'SN_163020007',
'SN_164299002',
'SN_164300005',
'SN_164301009',
'SN_164303007',
'SN_164299002',
'SN_238131007',
'SN_248348005',
'SN_248349002',
'SN_697930002',
'SN_310252000',
'SN_310356000',
'SN_310357009',
'SN_313005002',
'SN_314440001',
'SN_314445006',
'SN_314446007',
'SN_314449000',
'SN_314453003',
'SN_314460009',
'SN_314461008',
'SN_314462001',
'SN_315612005',
'SN_315613000',
'SN_42177007',
'SN_400967004',
'SN_400974009',
'SN_400975005',
'SN_401003006',
'SN_407554009',
'SN_407555005',
'SN_407556006',
'SN_407557002',
'SN_408512008',
'SN_412768003',
'SN_413606001',
'SN_413605002',
'SN_429745009',
'SN_72313002',
'SN_140411000006103',
'SN_162756007',
'SN_162760005',
'SN_162764001',
'SN_162992001',
'SN_703421000',
'SN_162757003',
'SN_164304001',
'SN_164302002',
'SN_162988008',
'SN_198081000000101',
'SN_198091000000104',
'SN_488551000006106',
'SN_500531000006107',
'SN_500581000006108',
'SN_500591000006106',
'SN_500601000006103',
'SN_500621000006108',
'SN_500631000006106',
'SN_500641000006101',
'SN_548871000006100',
'SN_549151000006105',
'SN_550011000006103',
'SN_1091811000000100',
'SN_335661000000109',
'SN_635711000006100',
'SN_635721000006108',
'SN_635771000006109',
'SN_649001000006104',
'SN_735251000006101',
'SN_854281000006107',
'SN_856881000006104',
'SN_856891000006101',
'SN_857321000006109',
'SN_857911000006102',
'SN_956251000006101',
'SN_446974000',
'SN_1577671000006100',
'SN_763131000000100',
'SN_1708211000006100',
'SN_1728141000006100',
'SN_87179004',
'SN_1808011000006110',
'SN_1808021000006100',
'SN_1808041000006110',
'SN_1808051000006110',
'SN_1808061000006100',
'SN_1808071000006100',
'SN_1849891000006110',
'SN_914741000000103',
'SN_1910901000006100',
'SN_1910911000006100',
'SN_1910921000006100',
'SN_1910931000006110',
'SN_926011000000101',
'SN_1928511000006100',
'SN_1928521000006110',
'SN_1929461000006110',
'SN_86651002',
'SN_1993951000006110',
'SN_1994021000006100',
'SN_758931000000104',
'SN_814081000000101',
'SN_814101000000107',
'SN_838441000000103',
'SN_843941000000100',
'SN_846911000000109',
'SN_846931000000101',
'SN_896691000000102',
'SN_914721000000105',
'SN_914731000000107',
'SN_920141000000102',
'SN_920161000000101',
'SN_920181000000105',
'SN_920201000000109',
'SN_920231000000103',
'SN_920251000000105',
'SN_920271000000101',
'SN_920291000000102',
'SN_920311000000101',
'SN_920841000000108',
'SN_920931000000108',
'SN_920951000000101',
'SN_920971000000105',
'SN_920991000000109',
'SN_921011000000105',
'SN_921031000000102',
'SN_921051000000109',
'SN_928021000000108',
'SN_716632005',
'SN_716579001',
'SN_6497000',
'SN_1036531000000110',
'SN_1036551000000100',
'SN_1036571000000100',
'SN_27113001',
'SN_27113001',
'SN_35425004',
'SN_48499001',
'SN_60621009',
'SN_60621009',
'SN_60621009',
'SN_60621009',
'SN_72313002',
'SN_72313002',
'SN_78564009',
'SN_78564009',
'SN_78564009',
'SN_162756007',
'SN_162756007',
'SN_162757003',
'SN_162757003',
'SN_162758008',
'SN_162759000',
'SN_162760005',
'SN_162760005',
'SN_162761009',
'SN_162764001',
'SN_162764001',
'SN_162765000',
'SN_162766004',
'SN_162769006',
'SN_162863004',
'SN_162863004',
'SN_162864005',
'SN_162986007',
'SN_162987003',
'SN_162988008',
'SN_162989000',
'SN_162990009',
'SN_162991008',
'SN_162992001',
'SN_162993006',
'SN_162994000',
'SN_162995004',
'SN_163020007',
'SN_163021006',
'SN_163021006',
'SN_163022004',
'SN_163022004',
'SN_163023009',
'SN_163023009',
'SN_163024003',
'SN_163024003',
'SN_163025002',
'SN_163025002',
'SN_163026001',
'SN_163026001',
'SN_163027005',
'SN_163027005',
'SN_163028000',
'SN_163028000',
'SN_163029008',
'SN_163029008',
'SN_163032006',
'SN_163032006',
'SN_163033001',
'SN_163034007',
'SN_163035008',
'SN_163036009',
'SN_163037000',
'SN_163037000',
'SN_164299002',
'SN_164299002',
'SN_164300005',
'SN_164301009',
'SN_164302002',
'SN_164302002',
'SN_164303007',
'SN_164304001',
'SN_164304001',
'SN_238131007',
'SN_248333004',
'SN_251074006',
'SN_251074006',
'SN_251074006',
'SN_310252000',
'SN_310356000',
'SN_310357009',
'SN_313005002',
'SN_313005002',
'SN_408512008',
'SN_408512008',
'SN_412768003',
'SN_429745009',
'SN_446974000',
'SN_697930002',
'SN_703421000',
'SN_198081000000101',
'SN_198091000000104',
'SN_335661000000109',
'SN_763131000000100',
'SN_838441000000103',
'SN_846911000000109',
'SN_846931000000101',
'SN_896691000000102',
'SN_920141000000102',
'SN_920161000000101',
'SN_920181000000105',
'SN_920201000000109',
'SN_920231000000103',
'SN_920251000000105',
'SN_920271000000101',
'SN_920291000000102',
'SN_920311000000101',
'SN_920841000000108',
'SN_920931000000108',
'SN_920951000000101',
'SN_920971000000105',
'SN_920991000000109',
'SN_921011000000105',
'SN_921031000000102',
'SN_921051000000109',
'SN_926011000000101',
'SN_162986007'
)

union

SELECT distinct 5, i.dbid
FROM concept c																			-- Source SNOMED concept
JOIN concept p ON p.id = 'SN_116680003'													-- "Is A" relationship (child of code)
JOIN concept_tct t ON t.target = c.dbid AND t.property = p.dbid							-- All children, grand children, etc
JOIN concept i ON i.dbid = t.source														-- Concepts
WHERE c.id IN (
'SN_60621009',
'SN_87179004',
'SN_102584008',
'SN_248333004',
'SN_162758008',
'SN_162759000',
'SN_162761009',
'SN_248333004',
'SN_27113001',
'SN_162765000',
'SN_162766004',
'SN_162769006',
'SN_27113001',
'SN_35425004',
'SN_48499001',
'SN_6497000',
'SN_162863004',
'SN_162864005',
'SN_162879003',
'SN_78564009',
'SN_162987003',
'SN_162988008',
'SN_162989000',
'SN_162990009',
'SN_162991008',
'SN_162992001',
'SN_162993006',
'SN_162994000',
'SN_162995004',
'SN_162986007',
'SN_163020007',
'SN_163020007',
'SN_163020007',
'SN_163021006',
'SN_163022004',
'SN_163023009',
'SN_163024003',
'SN_163025002',
'SN_163026001',
'SN_163027005',
'SN_163028000',
'SN_163029008',
'SN_163032006',
'SN_163033001',
'SN_163034007',
'SN_163035008',
'SN_163036009',
'SN_163037000',
'SN_163020007',
'SN_164299002',
'SN_164300005',
'SN_164301009',
'SN_164303007',
'SN_164299002',
'SN_238131007',
'SN_248348005',
'SN_248349002',
'SN_697930002',
'SN_310252000',
'SN_310356000',
'SN_310357009',
'SN_313005002',
'SN_314440001',
'SN_314445006',
'SN_314446007',
'SN_314449000',
'SN_314453003',
'SN_314460009',
'SN_314461008',
'SN_314462001',
'SN_315612005',
'SN_315613000',
'SN_42177007',
'SN_400967004',
'SN_400974009',
'SN_400975005',
'SN_401003006',
'SN_407554009',
'SN_407555005',
'SN_407556006',
'SN_407557002',
'SN_408512008',
'SN_412768003',
'SN_413606001',
'SN_413605002',
'SN_429745009',
'SN_72313002',
'SN_140411000006103',
'SN_162756007',
'SN_162760005',
'SN_162764001',
'SN_162992001',
'SN_703421000',
'SN_162757003',
'SN_164304001',
'SN_164302002',
'SN_162988008',
'SN_198081000000101',
'SN_198091000000104',
'SN_488551000006106',
'SN_500531000006107',
'SN_500581000006108',
'SN_500591000006106',
'SN_500601000006103',
'SN_500621000006108',
'SN_500631000006106',
'SN_500641000006101',
'SN_548871000006100',
'SN_549151000006105',
'SN_550011000006103',
'SN_1091811000000100',
'SN_335661000000109',
'SN_635711000006100',
'SN_635721000006108',
'SN_635771000006109',
'SN_649001000006104',
'SN_735251000006101',
'SN_854281000006107',
'SN_856881000006104',
'SN_856891000006101',
'SN_857321000006109',
'SN_857911000006102',
'SN_956251000006101',
'SN_446974000',
'SN_1577671000006100',
'SN_763131000000100',
'SN_1708211000006100',
'SN_1728141000006100',
'SN_87179004',
'SN_1808011000006110',
'SN_1808021000006100',
'SN_1808041000006110',
'SN_1808051000006110',
'SN_1808061000006100',
'SN_1808071000006100',
'SN_1849891000006110',
'SN_914741000000103',
'SN_1910901000006100',
'SN_1910911000006100',
'SN_1910921000006100',
'SN_1910931000006110',
'SN_926011000000101',
'SN_1928511000006100',
'SN_1928521000006110',
'SN_1929461000006110',
'SN_86651002',
'SN_1993951000006110',
'SN_1994021000006100',
'SN_758931000000104',
'SN_814081000000101',
'SN_814101000000107',
'SN_838441000000103',
'SN_843941000000100',
'SN_846911000000109',
'SN_846931000000101',
'SN_896691000000102',
'SN_914721000000105',
'SN_914731000000107',
'SN_920141000000102',
'SN_920161000000101',
'SN_920181000000105',
'SN_920201000000109',
'SN_920231000000103',
'SN_920251000000105',
'SN_920271000000101',
'SN_920291000000102',
'SN_920311000000101',
'SN_920841000000108',
'SN_920931000000108',
'SN_920951000000101',
'SN_920971000000105',
'SN_920991000000109',
'SN_921011000000105',
'SN_921031000000102',
'SN_921051000000109',
'SN_928021000000108',
'SN_716632005',
'SN_716579001',
'SN_6497000',
'SN_1036531000000110',
'SN_1036551000000100',
'SN_1036571000000100',
'SN_27113001',
'SN_27113001',
'SN_35425004',
'SN_48499001',
'SN_60621009',
'SN_60621009',
'SN_60621009',
'SN_60621009',
'SN_72313002',
'SN_72313002',
'SN_78564009',
'SN_78564009',
'SN_78564009',
'SN_162756007',
'SN_162756007',
'SN_162757003',
'SN_162757003',
'SN_162758008',
'SN_162759000',
'SN_162760005',
'SN_162760005',
'SN_162761009',
'SN_162764001',
'SN_162764001',
'SN_162765000',
'SN_162766004',
'SN_162769006',
'SN_162863004',
'SN_162863004',
'SN_162864005',
'SN_162986007',
'SN_162987003',
'SN_162988008',
'SN_162989000',
'SN_162990009',
'SN_162991008',
'SN_162992001',
'SN_162993006',
'SN_162994000',
'SN_162995004',
'SN_163020007',
'SN_163021006',
'SN_163021006',
'SN_163022004',
'SN_163022004',
'SN_163023009',
'SN_163023009',
'SN_163024003',
'SN_163024003',
'SN_163025002',
'SN_163025002',
'SN_163026001',
'SN_163026001',
'SN_163027005',
'SN_163027005',
'SN_163028000',
'SN_163028000',
'SN_163029008',
'SN_163029008',
'SN_163032006',
'SN_163032006',
'SN_163033001',
'SN_163034007',
'SN_163035008',
'SN_163036009',
'SN_163037000',
'SN_163037000',
'SN_164299002',
'SN_164299002',
'SN_164300005',
'SN_164301009',
'SN_164302002',
'SN_164302002',
'SN_164303007',
'SN_164304001',
'SN_164304001',
'SN_238131007',
'SN_248333004',
'SN_251074006',
'SN_251074006',
'SN_251074006',
'SN_310252000',
'SN_310356000',
'SN_310357009',
'SN_313005002',
'SN_313005002',
'SN_408512008',
'SN_408512008',
'SN_412768003',
'SN_429745009',
'SN_446974000',
'SN_697930002',
'SN_703421000',
'SN_198081000000101',
'SN_198091000000104',
'SN_335661000000109',
'SN_763131000000100',
'SN_838441000000103',
'SN_846911000000109',
'SN_846931000000101',
'SN_896691000000102',
'SN_920141000000102',
'SN_920161000000101',
'SN_920181000000105',
'SN_920201000000109',
'SN_920231000000103',
'SN_920251000000105',
'SN_920271000000101',
'SN_920291000000102',
'SN_920311000000101',
'SN_920841000000108',
'SN_920931000000108',
'SN_920951000000101',
'SN_920971000000105',
'SN_920991000000109',
'SN_921011000000105',
'SN_921031000000102',
'SN_921051000000109',
'SN_926011000000101',
'SN_162986007'
)