
insert into code_category_values (code_category_id, concept_dbid)
SELECT distinct 26, s.dbid-- , s.id, s.name, p2.id, p2.name, i.id, i.name, p.id, p.name, c.id, c.name
FROM concept c																			-- Source SNOMED concept
JOIN concept p ON p.id = 'SN_116680003'													-- "Is A" relationship (child of code)
JOIN concept_tct t ON t.target = c.dbid AND t.property = p.dbid							-- All children, grand children, etc
JOIN concept i ON i.dbid = t.source														-- Intermediary (just for info)
JOIN concept p2 ON p2.id IN ('SN_116680003', 'is_equivalent_to')						-- "Is A" and "Equivalent" relationships (self and legacy maps)
JOIN concept_property_object cpo ON cpo.value = t.source AND cpo.property = p2.dbid		-- All related
JOIN concept s ON s.dbid = cpo.dbid														-- Concepts
WHERE c.id in (
'SN_31611000006100',
'SN_34581000006105',
'SN_39091000006101',
'SN_74741000006107',
'SN_79851000006102',
'SN_79861000006100',
'SN_79871000006107',
'SN_87371000006101',
'SN_161851000006102',
'SN_209041000006107',
'SN_252251000006104',
'SN_252501000006101',
'SN_474391000006106',
'SN_474401000006108',
'SN_480961000006100',
'SN_484331000006100',
'SN_484341000006105',
'SN_484351000006107',
'SN_484371000006102',
'SN_484381000006104',
'SN_484391000006101',
'SN_487571000006100',
'SN_496781000006107',
'SN_496791000006105',
'SN_543511000006104',
'SN_543521000006107',
'SN_545091000006102',
'SN_550701000006103',
'SN_577331000006105',
'SN_577351000006103',
'SN_588431000006105',
'SN_588441000006100',
'SN_634051000006103',
'SN_646711000006105',
'SN_646721000006102',
'SN_646731000006104',
'SN_646741000006109',
'SN_646751000006106',
'SN_666621000006100',
'SN_698251000006108',
'SN_754991000006100',
'SN_805301000006104',
'SN_805461000006109',
'SN_820811000006109',
'SN_825681000006106',
'SN_825691000006109',
'SN_825881000006105',
'SN_825891000006108',
'SN_1760741000006110',
'SN_1760751000006110',
'SN_1760761000006110',
'SN_1760771000006100',
'SN_1760781000006100',
'SN_1760791000006100',
'SN_1760941000006110',
'SN_1760961000006110',
'SN_1760971000006100',
'SN_1760981000006100',
'SN_1761001000006100',
'SN_1761021000006110',
'SN_1761031000006100',
'SN_1761041000006100',
'SN_1761051000006100',
'SN_1761061000006100',
'SN_1761071000006110',
'SN_1761091000006110',
'SN_1761101000006100',
'SN_1761111000006100',
'SN_1761131000006110',
'SN_1761141000006100',
'SN_1761161000006100',
'SN_1761171000006110',
'SN_1761201000006110',
'SN_1761211000006110',
'SN_1761221000006100',
'SN_1761241000006100',
'SN_1761251000006110',
'SN_1761261000006110',
'SN_1761271000006100',
'SN_1761291000006100',
'SN_1761311000006100',
'SN_1761351000006100',
'SN_1761361000006100',
'SN_1761381000006110',
'SN_1761401000006110',
'SN_1761411000006110',
'SN_1761431000006100',
'SN_1761441000006110',
'SN_1761531000006100',
'SN_1761551000006110',
'SN_1761561000006110',
'SN_1761571000006100',
'SN_1761581000006100',
'SN_1761591000006100',
'SN_1761741000006100',
'SN_1761751000006100',
'SN_1761761000006100',
'SN_1761771000006100',
'SN_1761781000006110',
'SN_1761791000006110',
'SN_1761801000006110',
'SN_1761811000006100',
'SN_1761821000006100',
'SN_1761831000006100',
'SN_1761841000006110',
'SN_1761851000006110',
'SN_1761861000006110',
'SN_1761871000006100',
'SN_1761881000006100',
'SN_1761891000006100',
'SN_1761901000006100',
'SN_1761911000006100',
'SN_1761921000006110',
'SN_1761931000006110',
'SN_1761941000006100',
'SN_1761951000006100',
'SN_1761961000006100',
'SN_1761971000006110',
'SN_1761981000006100',
'SN_1761991000006110',
'SN_1762001000006100',
'SN_1762011000006110',
'SN_1762021000006100',
'SN_1762031000006100',
'SN_1762041000006110',
'SN_1762051000006110',
'SN_1762061000006110',
'SN_1762071000006100',
'SN_1762081000006100',
'SN_1762091000006100',
'SN_1762101000006110',
'SN_1762111000006110',
'SN_1762121000006100',
'SN_1762131000006100',
'SN_1762141000006110',
'SN_1762151000006110',
'SN_1762181000006100',
'SN_1762201000006100',
'SN_1762211000006100',
'SN_1762221000006110',
'SN_1762231000006110',
'SN_1762241000006100',
'SN_1762261000006100',
'SN_1968771000006110',
'SN_1968781000006100',
'SN_1968791000006110',
'SN_1968801000006110',
'SN_1968811000006110',
'SN_1968821000006100',
'SN_1968831000006100',
'SN_1968841000006110',
'SN_1968851000006110',
'SN_1968861000006100',
'SN_1968871000006100',
'SN_1968881000006100',
'SN_1968891000006100',
'SN_1968901000006100',
'SN_1968911000006100',
'SN_1968921000006110',
'SN_1968931000006110',
'SN_1968941000006100',
'SN_1968951000006100',
'SN_1968961000006100',
'SN_1968971000006110',
'SN_1968981000006110',
'SN_1968991000006100',
'SN_1969001000006100',
'SN_1969011000006110',
'SN_1969021000006100',
'SN_1969031000006100',
'SN_1969041000006110',
'SN_1969051000006110',
'SN_1969061000006110',
'SN_1969071000006100',
'SN_1969081000006100',
'SN_1969091000006100',
'SN_1969101000006110'
)

union

SELECT distinct 26, i.dbid
FROM concept c																			-- Source SNOMED concept
JOIN concept p ON p.id = 'SN_116680003'													-- "Is A" relationship (child of code)
JOIN concept_tct t ON t.target = c.dbid AND t.property = p.dbid							-- All children, grand children, etc
JOIN concept i ON i.dbid = t.source														-- Concepts
WHERE c.id IN (
'SN_31611000006100',
'SN_34581000006105',
'SN_39091000006101',
'SN_74741000006107',
'SN_79851000006102',
'SN_79861000006100',
'SN_79871000006107',
'SN_87371000006101',
'SN_161851000006102',
'SN_209041000006107',
'SN_252251000006104',
'SN_252501000006101',
'SN_474391000006106',
'SN_474401000006108',
'SN_480961000006100',
'SN_484331000006100',
'SN_484341000006105',
'SN_484351000006107',
'SN_484371000006102',
'SN_484381000006104',
'SN_484391000006101',
'SN_487571000006100',
'SN_496781000006107',
'SN_496791000006105',
'SN_543511000006104',
'SN_543521000006107',
'SN_545091000006102',
'SN_550701000006103',
'SN_577331000006105',
'SN_577351000006103',
'SN_588431000006105',
'SN_588441000006100',
'SN_634051000006103',
'SN_646711000006105',
'SN_646721000006102',
'SN_646731000006104',
'SN_646741000006109',
'SN_646751000006106',
'SN_666621000006100',
'SN_698251000006108',
'SN_754991000006100',
'SN_805301000006104',
'SN_805461000006109',
'SN_820811000006109',
'SN_825681000006106',
'SN_825691000006109',
'SN_825881000006105',
'SN_825891000006108',
'SN_1760741000006110',
'SN_1760751000006110',
'SN_1760761000006110',
'SN_1760771000006100',
'SN_1760781000006100',
'SN_1760791000006100',
'SN_1760941000006110',
'SN_1760961000006110',
'SN_1760971000006100',
'SN_1760981000006100',
'SN_1761001000006100',
'SN_1761021000006110',
'SN_1761031000006100',
'SN_1761041000006100',
'SN_1761051000006100',
'SN_1761061000006100',
'SN_1761071000006110',
'SN_1761091000006110',
'SN_1761101000006100',
'SN_1761111000006100',
'SN_1761131000006110',
'SN_1761141000006100',
'SN_1761161000006100',
'SN_1761171000006110',
'SN_1761201000006110',
'SN_1761211000006110',
'SN_1761221000006100',
'SN_1761241000006100',
'SN_1761251000006110',
'SN_1761261000006110',
'SN_1761271000006100',
'SN_1761291000006100',
'SN_1761311000006100',
'SN_1761351000006100',
'SN_1761361000006100',
'SN_1761381000006110',
'SN_1761401000006110',
'SN_1761411000006110',
'SN_1761431000006100',
'SN_1761441000006110',
'SN_1761531000006100',
'SN_1761551000006110',
'SN_1761561000006110',
'SN_1761571000006100',
'SN_1761581000006100',
'SN_1761591000006100',
'SN_1761741000006100',
'SN_1761751000006100',
'SN_1761761000006100',
'SN_1761771000006100',
'SN_1761781000006110',
'SN_1761791000006110',
'SN_1761801000006110',
'SN_1761811000006100',
'SN_1761821000006100',
'SN_1761831000006100',
'SN_1761841000006110',
'SN_1761851000006110',
'SN_1761861000006110',
'SN_1761871000006100',
'SN_1761881000006100',
'SN_1761891000006100',
'SN_1761901000006100',
'SN_1761911000006100',
'SN_1761921000006110',
'SN_1761931000006110',
'SN_1761941000006100',
'SN_1761951000006100',
'SN_1761961000006100',
'SN_1761971000006110',
'SN_1761981000006100',
'SN_1761991000006110',
'SN_1762001000006100',
'SN_1762011000006110',
'SN_1762021000006100',
'SN_1762031000006100',
'SN_1762041000006110',
'SN_1762051000006110',
'SN_1762061000006110',
'SN_1762071000006100',
'SN_1762081000006100',
'SN_1762091000006100',
'SN_1762101000006110',
'SN_1762111000006110',
'SN_1762121000006100',
'SN_1762131000006100',
'SN_1762141000006110',
'SN_1762151000006110',
'SN_1762181000006100',
'SN_1762201000006100',
'SN_1762211000006100',
'SN_1762221000006110',
'SN_1762231000006110',
'SN_1762241000006100',
'SN_1762261000006100',
'SN_1968771000006110',
'SN_1968781000006100',
'SN_1968791000006110',
'SN_1968801000006110',
'SN_1968811000006110',
'SN_1968821000006100',
'SN_1968831000006100',
'SN_1968841000006110',
'SN_1968851000006110',
'SN_1968861000006100',
'SN_1968871000006100',
'SN_1968881000006100',
'SN_1968891000006100',
'SN_1968901000006100',
'SN_1968911000006100',
'SN_1968921000006110',
'SN_1968931000006110',
'SN_1968941000006100',
'SN_1968951000006100',
'SN_1968961000006100',
'SN_1968971000006110',
'SN_1968981000006110',
'SN_1968991000006100',
'SN_1969001000006100',
'SN_1969011000006110',
'SN_1969021000006100',
'SN_1969031000006100',
'SN_1969041000006110',
'SN_1969051000006110',
'SN_1969061000006110',
'SN_1969071000006100',
'SN_1969081000006100',
'SN_1969091000006100',
'SN_1969101000006110'
);