
insert into code_category_values (code_category_id, concept_dbid)
SELECT distinct 6, s.dbid-- , s.id, s.name, p2.id, p2.name, i.id, i.name, p.id, p.name, c.id, c.name
FROM concept c																			-- Source SNOMED concept
JOIN concept p ON p.id = 'SN_116680003'													-- "Is A" relationship (child of code)
JOIN concept_tct t ON t.target = c.dbid AND t.property = p.dbid							-- All children, grand children, etc
JOIN concept i ON i.dbid = t.source														-- Intermediary (just for info)
JOIN concept p2 ON p2.id IN ('SN_116680003', 'is_equivalent_to')						-- "Is A" and "Equivalent" relationships (self and legacy maps)
JOIN concept_property_object cpo ON cpo.value = t.source AND cpo.property = p2.dbid		-- All related
JOIN concept s ON s.dbid = cpo.dbid														-- Concepts
WHERE c.id in (
'SN_1002311000006110',
'SN_1002571000006110',
'SN_1002581000006110',
'SN_1002591000006100',
'SN_1003281000006100',
'SN_1003291000006100',
'SN_1003521000006100',
'SN_1003531000006100',
'SN_1003541000006110',
'SN_1003551000006110',
'SN_1003561000006110',
'SN_1003571000006100',
'SN_1003581000006100',
'SN_1003651000006110',
'SN_1003661000006110',
'SN_1003671000006100',
'SN_1003681000006100',
'SN_1003691000006100',
'SN_1003701000006100',
'SN_1003711000006100',
'SN_1003721000006110',
'SN_1003731000006110',
'SN_1003741000006100',
'SN_1003751000006100',
'SN_1003761000006100',
'SN_1003771000006110',
'SN_1003781000006100',
'SN_1003791000006110',
'SN_1003801000006110',
'SN_1003811000006110',
'SN_1003821000006100',
'SN_1003831000006100',
'SN_1003841000006110',
'SN_1003851000006110',
'SN_1003861000006100',
'SN_1003871000006100',
'SN_1003881000006100',
'SN_1003891000006100',
'SN_1003901000006100',
'SN_1003911000006100',
'SN_1003921000006110',
'SN_1003931000006110',
'SN_1003941000006100',
'SN_1004221000006100',
'SN_1004231000006100',
'SN_1004241000006110',
'SN_1005841000006110',
'SN_1005851000006110',
'SN_1006181000006100',
'SN_1006191000006100',
'SN_1006201000006100',
'SN_1006211000006100',
'SN_1006221000006110',
'SN_1006231000006110',
'SN_1006241000006100',
'SN_1006251000006100',
'SN_1006261000006100',
'SN_1006271000006110',
'SN_1006281000006100',
'SN_1006291000006110',
'SN_1006301000006110',
'SN_1006311000006110',
'SN_1006321000006100',
'SN_1006331000006100',
'SN_1006341000006110',
'SN_1006351000006110',
'SN_1006361000006100',
'SN_1006371000006100',
'SN_1006381000006100',
'SN_1006391000006100',
'SN_1006401000006100',
'SN_1006411000006100',
'SN_1006421000006100',
'SN_1006431000006110',
'SN_1006441000006100',
'SN_1006451000006100',
'SN_1006461000006100',
'SN_1006471000006110',
'SN_1006481000006110',
'SN_1006491000006110',
'SN_1006501000006100',
'SN_1006511000006100',
'SN_1006521000006110',
'SN_1006531000006110',
'SN_1006541000006100',
'SN_1006711000006110',
'SN_1006721000006100',
'SN_1006741000006110',
'SN_1006751000006110',
'SN_1006771000006100',
'SN_1006811000006100',
'SN_1006831000006100',
'SN_1006841000006100',
'SN_1006851000006100',
'SN_1006861000006100',
'SN_1006871000006110',
'SN_1006881000006110',
'SN_1006891000006110',
'SN_1006911000006110',
'SN_1006921000006100',
'SN_1006931000006100',
'SN_1006941000006100',
'SN_1006951000006110',
'SN_1006961000006110',
'SN_1006971000006100',
'SN_1006981000006100',
'SN_1006991000006100',
'SN_1007001000006110',
'SN_1007011000006110',
'SN_1007021000006100',
'SN_1007031000006100',
'SN_1007041000006110',
'SN_1007051000006110',
'SN_1007061000006100',
'SN_1007071000006100',
'SN_1007081000006100',
'SN_1007101000006110',
'SN_1007111000006110',
'SN_1007121000006100',
'SN_1007131000006100',
'SN_1007691000006110',
'SN_1007701000006110',
'SN_1007711000006100',
'SN_1007721000006100',
'SN_1007731000006100',
'SN_1007741000006110',
'SN_1007751000006110',
'SN_1007761000006110',
'SN_1007771000006100',
'SN_1007781000006100',
'SN_1007791000006100',
'SN_1007801000006100',
'SN_1007811000006100',
'SN_1007821000006110',
'SN_1007831000006110',
'SN_1007841000006100',
'SN_1007851000006100',
'SN_1007861000006100',
'SN_1007871000006100',
'SN_1007881000006110',
'SN_1007891000006110',
'SN_1007901000006100',
'SN_1007911000006110',
'SN_1007921000006100',
'SN_1007931000006100',
'SN_1007941000006110',
'SN_1007951000006110',
'SN_1007961000006110',
'SN_1007971000006100',
'SN_1007981000006100',
'SN_1007991000006100',
'SN_1008001000006110',
'SN_1008011000006110',
'SN_1008021000006100',
'SN_1008031000006100',
'SN_1008041000006100',
'SN_1008051000006110',
'SN_1008541000006100',
'SN_1008561000006100',
'SN_1008571000006110',
'SN_1008581000006110',
'SN_1008591000006110',
'SN_1008601000006100'
)

union

SELECT distinct 6, i.dbid
FROM concept c																			-- Source SNOMED concept
JOIN concept p ON p.id = 'SN_116680003'													-- "Is A" relationship (child of code)
JOIN concept_tct t ON t.target = c.dbid AND t.property = p.dbid							-- All children, grand children, etc
JOIN concept i ON i.dbid = t.source														-- Concepts
WHERE c.id IN (
'SN_1002311000006110',
'SN_1002571000006110',
'SN_1002581000006110',
'SN_1002591000006100',
'SN_1003281000006100',
'SN_1003291000006100',
'SN_1003521000006100',
'SN_1003531000006100',
'SN_1003541000006110',
'SN_1003551000006110',
'SN_1003561000006110',
'SN_1003571000006100',
'SN_1003581000006100',
'SN_1003651000006110',
'SN_1003661000006110',
'SN_1003671000006100',
'SN_1003681000006100',
'SN_1003691000006100',
'SN_1003701000006100',
'SN_1003711000006100',
'SN_1003721000006110',
'SN_1003731000006110',
'SN_1003741000006100',
'SN_1003751000006100',
'SN_1003761000006100',
'SN_1003771000006110',
'SN_1003781000006100',
'SN_1003791000006110',
'SN_1003801000006110',
'SN_1003811000006110',
'SN_1003821000006100',
'SN_1003831000006100',
'SN_1003841000006110',
'SN_1003851000006110',
'SN_1003861000006100',
'SN_1003871000006100',
'SN_1003881000006100',
'SN_1003891000006100',
'SN_1003901000006100',
'SN_1003911000006100',
'SN_1003921000006110',
'SN_1003931000006110',
'SN_1003941000006100',
'SN_1004221000006100',
'SN_1004231000006100',
'SN_1004241000006110',
'SN_1005841000006110',
'SN_1005851000006110',
'SN_1006181000006100',
'SN_1006191000006100',
'SN_1006201000006100',
'SN_1006211000006100',
'SN_1006221000006110',
'SN_1006231000006110',
'SN_1006241000006100',
'SN_1006251000006100',
'SN_1006261000006100',
'SN_1006271000006110',
'SN_1006281000006100',
'SN_1006291000006110',
'SN_1006301000006110',
'SN_1006311000006110',
'SN_1006321000006100',
'SN_1006331000006100',
'SN_1006341000006110',
'SN_1006351000006110',
'SN_1006361000006100',
'SN_1006371000006100',
'SN_1006381000006100',
'SN_1006391000006100',
'SN_1006401000006100',
'SN_1006411000006100',
'SN_1006421000006100',
'SN_1006431000006110',
'SN_1006441000006100',
'SN_1006451000006100',
'SN_1006461000006100',
'SN_1006471000006110',
'SN_1006481000006110',
'SN_1006491000006110',
'SN_1006501000006100',
'SN_1006511000006100',
'SN_1006521000006110',
'SN_1006531000006110',
'SN_1006541000006100',
'SN_1006711000006110',
'SN_1006721000006100',
'SN_1006741000006110',
'SN_1006751000006110',
'SN_1006771000006100',
'SN_1006811000006100',
'SN_1006831000006100',
'SN_1006841000006100',
'SN_1006851000006100',
'SN_1006861000006100',
'SN_1006871000006110',
'SN_1006881000006110',
'SN_1006891000006110',
'SN_1006911000006110',
'SN_1006921000006100',
'SN_1006931000006100',
'SN_1006941000006100',
'SN_1006951000006110',
'SN_1006961000006110',
'SN_1006971000006100',
'SN_1006981000006100',
'SN_1006991000006100',
'SN_1007001000006110',
'SN_1007011000006110',
'SN_1007021000006100',
'SN_1007031000006100',
'SN_1007041000006110',
'SN_1007051000006110',
'SN_1007061000006100',
'SN_1007071000006100',
'SN_1007081000006100',
'SN_1007101000006110',
'SN_1007111000006110',
'SN_1007121000006100',
'SN_1007131000006100',
'SN_1007691000006110',
'SN_1007701000006110',
'SN_1007711000006100',
'SN_1007721000006100',
'SN_1007731000006100',
'SN_1007741000006110',
'SN_1007751000006110',
'SN_1007761000006110',
'SN_1007771000006100',
'SN_1007781000006100',
'SN_1007791000006100',
'SN_1007801000006100',
'SN_1007811000006100',
'SN_1007821000006110',
'SN_1007831000006110',
'SN_1007841000006100',
'SN_1007851000006100',
'SN_1007861000006100',
'SN_1007871000006100',
'SN_1007881000006110',
'SN_1007891000006110',
'SN_1007901000006100',
'SN_1007911000006110',
'SN_1007921000006100',
'SN_1007931000006100',
'SN_1007941000006110',
'SN_1007951000006110',
'SN_1007961000006110',
'SN_1007971000006100',
'SN_1007981000006100',
'SN_1007991000006100',
'SN_1008001000006110',
'SN_1008011000006110',
'SN_1008021000006100',
'SN_1008031000006100',
'SN_1008041000006100',
'SN_1008051000006110',
'SN_1008541000006100',
'SN_1008561000006100',
'SN_1008571000006110',
'SN_1008581000006110',
'SN_1008591000006110',
'SN_1008601000006100'
);