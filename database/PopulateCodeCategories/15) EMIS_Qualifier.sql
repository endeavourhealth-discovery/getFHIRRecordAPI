
insert into code_category_values (code_category_id, concept_dbid)
SELECT distinct 15, s.dbid-- , s.id, s.name, p2.id, p2.name, i.id, i.name, p.id, p.name, c.id, c.name
FROM concept c																			-- Source SNOMED concept
JOIN concept p ON p.id = 'SN_116680003'													-- "Is A" relationship (child of code)
JOIN concept_tct t ON t.target = c.dbid AND t.property = p.dbid							-- All children, grand children, etc
JOIN concept i ON i.dbid = t.source														-- Intermediary (just for info)
JOIN concept p2 ON p2.id IN ('SN_116680003', 'is_equivalent_to')						-- "Is A" and "Equivalent" relationships (self and legacy maps)
JOIN concept_property_object cpo ON cpo.value = t.source AND cpo.property = p2.dbid		-- All related
JOIN concept s ON s.dbid = cpo.dbid														-- Concepts
WHERE c.id in (
'SN_29970001',
'SN_32088001',
'SN_53046009',
'SN_70905002',
'SN_81170007',
'SN_86777004',
'SN_255216001',
'SN_258097001',
'SN_272070003',
'SN_272099008',
'SN_1538141000006100',
'SN_1538151000006100',
'SN_1538161000006100',
'SN_1538171000006110',
'SN_1538181000006110',
'SN_1538191000006100',
'SN_1538201000006110',
'SN_1538211000006110',
'SN_1538221000006100',
'SN_1538231000006100',
'SN_1538241000006100',
'SN_1538251000006110',
'SN_1538261000006110',
'SN_1538271000006100',
'SN_1538281000006100',
'SN_1538291000006100',
'SN_1538301000006100',
'SN_1538311000006100',
'SN_1538321000006100',
'SN_1538331000006110',
'SN_1538341000006100',
'SN_1538351000006100',
'SN_1538361000006100',
'SN_1538371000006110',
'SN_1538381000006110',
'SN_1538391000006110',
'SN_1538401000006110',
'SN_1538411000006110',
'SN_1538421000006100',
'SN_1538431000006100',
'SN_1538441000006110',
'SN_1538451000006110',
'SN_1538461000006100',
'SN_1538471000006100',
'SN_1538481000006100',
'SN_1538491000006100',
'SN_1538501000006100',
'SN_1538511000006110',
'SN_1538521000006100',
'SN_1538531000006100',
'SN_1538541000006110',
'SN_1538551000006110',
'SN_1538561000006110',
'SN_1538571000006100',
'SN_1538581000006100',
'SN_1538591000006100',
'SN_1538601000006110',
'SN_1538611000006110',
'SN_1538621000006100',
'SN_1538631000006100',
'SN_1538641000006110',
'SN_1538651000006100',
'SN_1538661000006110',
'SN_1538671000006100',
'SN_1538681000006100',
'SN_1538691000006100',
'SN_1538701000006100',
'SN_1538711000006100',
'SN_1538721000006110',
'SN_1538731000006110',
'SN_1538741000006100',
'SN_1538751000006100',
'SN_1538761000006100',
'SN_1538771000006100',
'SN_1538781000006110',
'SN_1538791000006110',
'SN_1538801000006110',
'SN_1538811000006100',
'SN_1538821000006100',
'SN_1538831000006100',
'SN_1538841000006110',
'SN_1538851000006110',
'SN_1538861000006110',
'SN_1538871000006100',
'SN_1538881000006100',
'SN_1538891000006100',
'SN_1538901000006100',
'SN_1538911000006100',
'SN_1538921000006110',
'SN_1538931000006110',
'SN_1538941000006100',
'SN_1538951000006100',
'SN_1538961000006100',
'SN_1538971000006110',
'SN_1538981000006100',
'SN_1538991000006110',
'SN_1539001000006110',
'SN_1539011000006110',
'SN_1539021000006100',
'SN_1539031000006100',
'SN_1539041000006100',
'SN_1539051000006110',
'SN_1539061000006110',
'SN_1539071000006100',
'SN_1539081000006100',
'SN_1539091000006100',
'SN_1539101000006110',
'SN_1539111000006100',
'SN_1578201000006110',
'SN_1578211000006110',
'SN_1578221000006100',
'SN_1578231000006100',
'SN_1578241000006110',
'SN_1583971000006100',
'SN_1583981000006110',
'SN_1672041000006110',
'SN_1672051000006110',
'SN_1672061000006100',
'SN_1672071000006100',
'SN_1672081000006100',
'SN_1672091000006100',
'SN_1672101000006110',
'SN_1672111000006110',
'SN_1672121000006100',
'SN_1672131000006100',
'SN_1672141000006100',
'SN_6736007',
'SN_1672161000006110',
'SN_1672171000006100',
'SN_1672181000006100',
'SN_1672191000006100',
'SN_1672201000006100',
'SN_1672211000006100',
'SN_1672221000006110',
'SN_1672231000006110',
'SN_1672241000006100',
'SN_1672251000006100',
'SN_1672261000006100',
'SN_1672731000006100',
'SN_1674871000006100',
'SN_1674881000006100',
'SN_1674891000006100',
'SN_1695991000006100',
'SN_1696001000006100',
'SN_1696011000006100',
'SN_1696021000006110',
'SN_1696031000006110',
'SN_1696041000006100',
'SN_1696051000006100',
'SN_1696061000006100',
'SN_1696071000006100',
'SN_1696081000006110',
'SN_1696091000006110',
'SN_1696101000006100',
'SN_1697791000006110',
'SN_1697801000006110',
'SN_1697811000006100',
'SN_1697821000006100',
'SN_1697831000006100',
'SN_1697841000006110',
'SN_1697851000006110',
'SN_1697861000006110',
'SN_1697871000006100',
'SN_1711291000006100',
'SN_1711301000006100',
'SN_1711311000006100',
'SN_1711421000006100',
'SN_1711431000006100',
'SN_1711441000006110',
'SN_1711451000006110',
'SN_1716751000006110',
'SN_1762711000006110',
'SN_363691001',
'SN_1763151000006100',
'SN_128977007',
'SN_128978002',
'SN_1763231000006100',
'SN_255239007',
'SN_27789000',
'SN_255218000',
'SN_225761000',
'SN_106229004',
'SN_15874002',
'SN_423493009',
'SN_1788151000006110',
'SN_1822261000006110',
'SN_718941000000104',
'SN_1878381000006110',
'SN_1878391000006110',
'SN_1878841000006110',
'SN_1931841000006100',
'SN_416151008',
'SN_1931861000006110',
'SN_11934891000006100',
'SN_11934901000006100'
)

union

SELECT distinct 15, i.dbid
FROM concept c																			-- Source SNOMED concept
JOIN concept p ON p.id = 'SN_116680003'													-- "Is A" relationship (child of code)
JOIN concept_tct t ON t.target = c.dbid AND t.property = p.dbid							-- All children, grand children, etc
JOIN concept i ON i.dbid = t.source														-- Concepts
WHERE c.id IN (
'SN_29970001',
'SN_32088001',
'SN_53046009',
'SN_70905002',
'SN_81170007',
'SN_86777004',
'SN_255216001',
'SN_258097001',
'SN_272070003',
'SN_272099008',
'SN_1538141000006100',
'SN_1538151000006100',
'SN_1538161000006100',
'SN_1538171000006110',
'SN_1538181000006110',
'SN_1538191000006100',
'SN_1538201000006110',
'SN_1538211000006110',
'SN_1538221000006100',
'SN_1538231000006100',
'SN_1538241000006100',
'SN_1538251000006110',
'SN_1538261000006110',
'SN_1538271000006100',
'SN_1538281000006100',
'SN_1538291000006100',
'SN_1538301000006100',
'SN_1538311000006100',
'SN_1538321000006100',
'SN_1538331000006110',
'SN_1538341000006100',
'SN_1538351000006100',
'SN_1538361000006100',
'SN_1538371000006110',
'SN_1538381000006110',
'SN_1538391000006110',
'SN_1538401000006110',
'SN_1538411000006110',
'SN_1538421000006100',
'SN_1538431000006100',
'SN_1538441000006110',
'SN_1538451000006110',
'SN_1538461000006100',
'SN_1538471000006100',
'SN_1538481000006100',
'SN_1538491000006100',
'SN_1538501000006100',
'SN_1538511000006110',
'SN_1538521000006100',
'SN_1538531000006100',
'SN_1538541000006110',
'SN_1538551000006110',
'SN_1538561000006110',
'SN_1538571000006100',
'SN_1538581000006100',
'SN_1538591000006100',
'SN_1538601000006110',
'SN_1538611000006110',
'SN_1538621000006100',
'SN_1538631000006100',
'SN_1538641000006110',
'SN_1538651000006100',
'SN_1538661000006110',
'SN_1538671000006100',
'SN_1538681000006100',
'SN_1538691000006100',
'SN_1538701000006100',
'SN_1538711000006100',
'SN_1538721000006110',
'SN_1538731000006110',
'SN_1538741000006100',
'SN_1538751000006100',
'SN_1538761000006100',
'SN_1538771000006100',
'SN_1538781000006110',
'SN_1538791000006110',
'SN_1538801000006110',
'SN_1538811000006100',
'SN_1538821000006100',
'SN_1538831000006100',
'SN_1538841000006110',
'SN_1538851000006110',
'SN_1538861000006110',
'SN_1538871000006100',
'SN_1538881000006100',
'SN_1538891000006100',
'SN_1538901000006100',
'SN_1538911000006100',
'SN_1538921000006110',
'SN_1538931000006110',
'SN_1538941000006100',
'SN_1538951000006100',
'SN_1538961000006100',
'SN_1538971000006110',
'SN_1538981000006100',
'SN_1538991000006110',
'SN_1539001000006110',
'SN_1539011000006110',
'SN_1539021000006100',
'SN_1539031000006100',
'SN_1539041000006100',
'SN_1539051000006110',
'SN_1539061000006110',
'SN_1539071000006100',
'SN_1539081000006100',
'SN_1539091000006100',
'SN_1539101000006110',
'SN_1539111000006100',
'SN_1578201000006110',
'SN_1578211000006110',
'SN_1578221000006100',
'SN_1578231000006100',
'SN_1578241000006110',
'SN_1583971000006100',
'SN_1583981000006110',
'SN_1672041000006110',
'SN_1672051000006110',
'SN_1672061000006100',
'SN_1672071000006100',
'SN_1672081000006100',
'SN_1672091000006100',
'SN_1672101000006110',
'SN_1672111000006110',
'SN_1672121000006100',
'SN_1672131000006100',
'SN_1672141000006100',
'SN_6736007',
'SN_1672161000006110',
'SN_1672171000006100',
'SN_1672181000006100',
'SN_1672191000006100',
'SN_1672201000006100',
'SN_1672211000006100',
'SN_1672221000006110',
'SN_1672231000006110',
'SN_1672241000006100',
'SN_1672251000006100',
'SN_1672261000006100',
'SN_1672731000006100',
'SN_1674871000006100',
'SN_1674881000006100',
'SN_1674891000006100',
'SN_1695991000006100',
'SN_1696001000006100',
'SN_1696011000006100',
'SN_1696021000006110',
'SN_1696031000006110',
'SN_1696041000006100',
'SN_1696051000006100',
'SN_1696061000006100',
'SN_1696071000006100',
'SN_1696081000006110',
'SN_1696091000006110',
'SN_1696101000006100',
'SN_1697791000006110',
'SN_1697801000006110',
'SN_1697811000006100',
'SN_1697821000006100',
'SN_1697831000006100',
'SN_1697841000006110',
'SN_1697851000006110',
'SN_1697861000006110',
'SN_1697871000006100',
'SN_1711291000006100',
'SN_1711301000006100',
'SN_1711311000006100',
'SN_1711421000006100',
'SN_1711431000006100',
'SN_1711441000006110',
'SN_1711451000006110',
'SN_1716751000006110',
'SN_1762711000006110',
'SN_363691001',
'SN_1763151000006100',
'SN_128977007',
'SN_128978002',
'SN_1763231000006100',
'SN_255239007',
'SN_27789000',
'SN_255218000',
'SN_225761000',
'SN_106229004',
'SN_15874002',
'SN_423493009',
'SN_1788151000006110',
'SN_1822261000006110',
'SN_718941000000104',
'SN_1878381000006110',
'SN_1878391000006110',
'SN_1878841000006110',
'SN_1931841000006100',
'SN_416151008',
'SN_1931861000006110',
'SN_11934891000006100',
'SN_11934901000006100'
);